Algoritmo carteiraInvestimento

Tipo
	invest = registro
		porExperada : real
		porAtual    : real
		valorReal   : real
Fim_registro
Var
	tiposI  : Vetor[1..5] de invest
	desba   : Vetor[1..2] de Inteiro 
	i : Inteiro
	soma, a, j : Real

Início
	Repita
		Para i de 0 até 5 passo 1 faça
			Escreval ("Quantos porcento você deseja investir na categoria", i)
			Leia (tiposI[i].porExperada)
			Se (j = 0) Então
				j <- tipoI[i].porExperada
			Senão
				j <- j + tipoI[i].porExperada
			Fim_se
		Fim_para	
			Se (j <> 100) então 
				escreval("Erro. Valor invalido, tente novamente")
			Fim_se
	Até_que (j = 100)
	

	Para i de 0 até 5 passo 1 faça
		Escreval("Quanto você tem investido na categoria", i)
		Leia (tiposI[i].valorReal)
	Fim_para

	soma <- 0
	Para i de 0 até 5 passo 1 faça
		Se (soma = 0) então
			soma <- tiposI[i].valorReal
		Senão
			soma <- soma + tipoI[i].valorReal	
		Fim_se
	Fim_para
	
	Escreval("Dinheiro total investido:", soma)
	
	Para i de 0 até 5 passo 1 faça
		tipoI[i].porAtual <- (tipoI[i].valorReal * 100)/soma
	Fim_para
		
	Escreval("A porcentagem desejada é:")
	Escreval("1-CDBs:", tipoI[1].porExperada) 
	Escreval("2-Ações:", tipoI[2].porExperada)
	Escreval("3-Fundos imobiliarios:", tipoI[3].porExperada)
	Escreval("4-Stoks:", tipoI[4].porExperada)
	Escreval("5-Reits:", tipoI[5].porExperada)

	Escreval("A porcentagem atual é:")
	Escreval("1-CDBs:", tipoI[1].porAtual) 
	Escreval("2-Ações:", tipoI[2].porAtual)
	Escreval("3-Fundos imobiliarios:", tipoI[3].porAtual)
	Escreval("4-Stoks:", tipoI[4].porAtual)
	Escreval("5-Reits:", tipoI[5].porAtual)

	Para i de 0 até 5 passo 1 faça
		Se ((tipoI[i].porAtual - tipoI[i].porExperado) < 0) Então
			a <- (tipoI[i].porAtual - tipoI[i].porExperado) * (-1)
		Senão
			a <- (tipoI[i].porAtual - tipoI[i].porExperado) 
		Fim_se

		Se(desba[1] = 0) OU (desba[2] < a) Então
			desba[1] <- a;
			desba[0] <- i;
		Fim_se
	Fim_para
	
	Escreval ("A categoria mais desbalanciada é a" desba[0])

Fim				
		
		 	
		
		